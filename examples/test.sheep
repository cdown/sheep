(variable test
  (with (nr 1)
    (function (result)
      (ddump
        (reduce concat
                (list (string nr) ": "
                      (if result "ok" "failed"))))
      (set nr (+ nr 1)))))

(test (= ()
         (quote ())))

(test (= ()
         (list)))

(test (= (list 2 3)
         (tail (list 1 2 3))))

(test (= (list 1 2 3)
         (with (a (quote (1 2 3)))
           a)))

(test (= (quote a)
         ((function (x)
            x)
          (quote a))))

(test (= true
         (block
           (function outer (x)
             (function inner ()
               x)
             (inner))
           (outer true))))

(test (= (list 42 42)
         (block
           (function tau (x)
             (if x
               (tau false)
               42))
           (list (tau true) (tau false)))))

(test (= (quote ((1 1) (2 2) (3 3) (4 4)))
         (map (function (x)
                (list x x))
              (list 1 2 3 4))))

(test (= 5050
         (block
           (function numbers (from)
             (if from
               (cons from (numbers (- from 1)))
               ()))
           (reduce + (numbers 100)))))
