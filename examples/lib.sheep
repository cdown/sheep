# library function ideas

(function nth-tail (n list)
  (if (and list n)
    (nth-tail (- n 1) (tail list))
    (tail list)))

(function nth (n list)
  (head (if (and list n)
          (nth-tail (- n 1) list)
          list)))

(function reduce (op list)
  (function iter (acc pos)
    (if pos
      (iter (op acc (head pos))
            (tail pos))
      acc))
  (iter (op (nth 0 list)
            (nth 1 list))
        (nth-tail 1 list)))
